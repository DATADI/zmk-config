/*
 * Copyright (c) 2020 The ZMK Contributors
 * SPDX-License-Identifier: MIT
 */

#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>

/* 1. 硬件配置：启用中间旋钮 */
&mid_encoder { status = "okay"; };

&sensors {
    status = "okay";
    sensors = <&mid_encoder>;
};

/ {
    behaviors {
        /* * 定义一个“双击行为” (Tap Dance)
         * 逻辑：
         * 按 1 下 -> 执行第 1 个动作 (播放/暂停)
         * 按 2 下 -> 执行第 2 个动作 (清除蓝牙)
         */
        td_bt: tap_dance_0 {
            compatible = "zmk,behavior-tap-dance";
            #binding-cells = <0>; /* 关键：这告诉编译器，这个行为不需要参数！ */
            tapping-term-ms = <300>; /* 双击间隔时间 */
            bindings = <&kp C_PP>, <&bt BT_CLR>;
        };
    };

    keymap {
        compatible = "zmk,keymap";

        default_layer {
            /* * 这里的 &td_bt 不需要任何参数
             * 编译器绝对不会报错说 "IDX_2 undeclared"
             */
            bindings = <
                &none      &td_bt      &none
                &none      &none       &none
                &none      &none       &none
            >;

            sensor-bindings = <&inc_dec_kp PAGE_DOWN PAGE_UP>;
        };
    };
};